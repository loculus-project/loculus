{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "name": {
      "groups": ["general"],
      "type": "string",
      "default": "Loculus",
      "description": "The name of the Loculus instance"
    },
    "logo": {
      "groups": ["general"],
      "type": "object",
      "description": "Configuration for the logo",
      "properties": {
        "url": {
          "groups": ["general"],
          "type": "string",
          "description": "URL path to the logo image file"
        },
        "width": {
          "groups": ["general"],
          "type": "integer",
          "default": 100,
          "description": "Width of the logo in pixels"
        },
        "height": {
          "groups": ["general"],
          "type": "integer",
          "default": 100,
          "description": "Height of the logo in pixels"
        }
      }
    },
    "accessionPrefix": {
      "groups": ["general"],
      "group": "general",
      "type": "string",
      "default": "LOC_",
      "description": "Prefix used for accession numbers"
    },
    "environment": {
      "groups": ["general"],
      "type": "string",
      "enum": ["local", "server"],
      "default": "server",
      "description": "Deployment environment. local for development, server for production"
    },
    "host": {
      "groups": ["general"],
      "type": "string",
      "description": "Hostname where Loculus will be accessible"
    },
    "bannerMessage": {
      "groups": ["general"],
      "type": "string",
      "default": "This is a demonstration environment. It may contain non-accurate test data and should not be used for real-world applications. Data will be deleted regularly.",
      "description": "Banner message (as HTML) to display at the very top of the page"
    },
    "welcomeMessageHTML": {
      "groups": ["general"],
      "type": ["string", "null"],
      "description": "A custom welcome message to be shown on the landing page"
    },
    "additionalHeadHTML": {
      "groups": ["general"],
      "type": "string",
      "description": "Additional HTML to inject into the <head> of pages"
    },
    "createTestAccounts": {
      "groups": ["general"],
      "type": "boolean",
      "description": "If true, creates the users testuser and superuser"
    },
    "robotsNoindexHeader": {
      "groups": ["general"],
      "type": "boolean",
      "description": "If true, adds a noindex header to prevent search engine indexing"
    },
    "seqSets": {
      "groups": ["general"],
      "type": "object",
      "properties": {
        "enabled": {
          "groups": ["general"],
          "type": "boolean",
          "description": "Enable/disable SeqSets. If false, `seqSets.crossRef` can be omitted."
        },
        "crossRef": {
          "groups": ["general"],
          "type": ["object"],
          "description": "Configuration for CrossRef integration. Set to `null` to disable CrossRef integration (you can still use SeqSets without CrossRef DOIs).",
          "properties": {
            "DOIPrefix": {
              "groups": ["general"],
              "type": "string",
              "description": "The DOI prefix for SeqSets"
            },
            "endpoint": {
              "groups": ["general"],
              "type": "string",
              "description": "The API endpoint for CrossRef"
            },
            "databaseName": {
              "groups": ["general"],
              "type": "string",
              "description": "The database name for CrossRef"
            },
            "email": {
              "groups": ["general"],
              "type": "string",
              "format": "email",
              "description": "The email address associated with the CrossRef account"
            },
            "organization": {
              "groups": ["general"],
              "type": "string",
              "description": "The organization name for CrossRef"
            },
            "hostUrl": {
              "groups": ["general"],
              "type": "string",
              "description": "The host URL for CrossRef callbacks"
            }
          }
        }
      }
    },
    "gitHubMainUrl": {
      "groups": ["general"],
      "type": "string",
      "default": "https://github.com/loculus-project/loculus",
      "description": "The link that the GitHub icon in the footer points to"
    },
    "website": {
      "groups": ["website"],
      "type": "object",
      "description": "Website specific setting",
      "properties": {
        "websiteConfig": {
          "groups": ["website"],
          "type": "object",
          "description": "Settings for the `website_config.json`",
          "properties": {
            "enableLoginNavigationItem": {
              "groups": ["website"],
              "type": "boolean",
              "default": true,
              "description": "Whether the website should show the login button."
            },
            "enableSubmissionNavigationItem": {
              "groups": ["website"],
              "type": "boolean",
              "default": true,
              "description": "Whether the website should show \"Submit\" link in the top navigation bar."
            },
            "enableSubmissionPages": {
              "groups": ["website"],
              "type": "boolean",
              "default": true,
              "description": "Whether to completely disable submission related pages. Setting this to false is useful when hosting Loculus for analysis-only purposes."
            }
          }
        },
        "runtimeConfig": {
          "type": "object",
          "properties": {
            "public": {
              "groups": ["website"],
              "type": "object",
              "description": "Settings for the `public` section of the `runtime_config.json`",
              "properties": {
                "backendUrl": {
                  "groups": ["website"],
                  "type": "string",
                  "description": "Overwrite the URL where the client-side website code expects the Loculus backend"
                },
                "keycloakUrl": {
                  "groups": ["website"],
                  "type": "string",
                  "description": "Overwrite the URL where the client-side website code expects the Keycloak"
                },
                "lapisUrlTemplate": {
                  "groups": ["website"],
                  "type": "string",
                  "description": "Overwrite the URLs where the client-side website code expects the LAPIS instances. Must contain `%organism%` as a placeholder."
                }
              }
            }
          }
        }
      }
    },
    "auth": {
      "groups": ["auth"],
      "type": "object",
      "description": "User authentication (Keycloak settings)",
      "properties": {
        "smtp": {
          "groups": ["auth"],
          "type": "object",
          "description": "Configuration for email sending",
          "properties": {
            "host": {
              "groups": ["auth"],
              "type": "string",
              "description": "SMTP server hostname"
            },
            "port": {
              "groups": ["auth"],
              "type": "integer",
              "description": "SMTP server port"
            },
            "user": {
              "groups": ["auth"],
              "type": "string",
              "description": "SMTP username for authentication"
            },
            "replyTo": {
              "groups": ["auth"],
              "type": "string",
              "format": "email",
              "description": "Reply-to email address for sent emails"
            },
            "from": {
              "groups": ["auth"],
              "type": "string",
              "format": "email",
              "description": "From email address for sent emails"
            },
            "envelopeFrom": {
              "groups": ["auth"],
              "type": "string",
              "format": "email",
              "description": "Envelope from address for sent emails"
            }
          }
        },
        "verifyEmail": {
          "groups": ["auth"],
          "type": "boolean",
          "default": true,
          "description": "If true, requires email verification for new accounts"
        },
        "resetPasswordAllowed": {
          "groups": ["auth"],
          "type": "boolean",
          "default": true,
          "description": "If true, allows users to reset their passwords"
        },
        "registrationAllowed": {
          "groups": ["auth"],
          "type": "boolean",
          "default": true,
          "description": "If true, allows users to register new accounts in Keycloak."
        }
      }
    },
    "insecureCookies": {
      "groups": ["auth"],
      "type": "boolean",
      "default": false,
      "description": "If true, allows insecure cookies."
    },
    "registrationMessage": {
      "groups": ["auth"],
      "type": "string",
      "default": "You must agree to the <a href='http://main.loculus.org/terms'>terms of use</a>.",
      "description": "Message displayed during user registration, typically including terms of service."
    },
    "runDevelopmentMainDatabase": {
      "groups": ["db"],
      "type": "boolean",
      "default": true,
      "description": "If true, runs a development database within the cluster."
    },
    "runDevelopmentKeycloakDatabase": {
      "groups": ["db"],
      "type": "boolean",
      "default": true,
      "description": "If true, runs a development Keycloak database within the cluster."
    },
    "developmentDatabasePersistence": {
      "groups": ["db"],
      "type": "boolean",
      "default": true,
      "description": "If true, makes the database on the argocd preview persistent."
    },
    "organisms": {
      "type": "object",
      "patternProperties": {
        "^.*$": {
          "type": "object",
          "properties": {
            "schema": {
              "type": "object",
              "properties": {
                "organismName": {
                  "type": "string"
                },
                "image": {
                  "type": "string"
                },
                "loadSequencesAutomatically": {
                  "type": "boolean",
                  "default": true
                },
                "metadata": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "displayName": {
                        "type": "string"
                      },
                      "type": {
                        "type": "string"
                      },
                      "required": {
                        "type": "boolean"
                      },
                      "definition": {
                        "type": "string"
                      },
                      "guidance": {
                        "type": "string"
                      },
                      "generateIndex": {
                        "type": "boolean"
                      },
                      "autocomplete": {
                        "type": "boolean"
                      }
                    },
                    "required": ["name", "displayName", "type"]
                  }
                }
              },
              "required": ["organismName"]
            },
            "preprocessing": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "version": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "image": {
                    "type": "string"
                  },
                  "args": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "configFile": {
                    "type": "object"
                  }
                },
                "required": ["version", "image"]
              }
            },
            "referenceGenomes": {
              "type": "object",
              "properties": {
                "nucleotideSequences": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "sequence": {
                        "type": "string"
                      },
                      "insdcAccessionFull": {
                        "type": "string"
                      }
                    },
                    "required": ["name", "sequence"]
                  }
                },
                "genes": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "sequence": {
                        "type": "string"
                      }
                    },
                    "required": ["name", "sequence"]
                  }
                }
              }
            }
          },
          "required": ["schema"]
        }
      }
    },
    "lineageSystemDefinitions": {
      "type": "object",
      "patternProperties": {
        "^.*$": {
          "type": "object",
          "patternProperties": {
            "^[0-9]+$": {
              "type": "string",
              "format": "uri"
            }
          }
        }
      }
    }
  },
  "required": ["name"]
}