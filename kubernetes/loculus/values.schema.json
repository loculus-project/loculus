{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "name": {
      "groups": ["general"],
      "type": "string",
      "default": "Loculus",
      "description": "The name of the Loculus instance"
    },
    "logo": {
      "groups": ["general"],
      "type": "object",
      "description": "Configuration for the logo",
      "properties": {
        "url": {
          "groups": ["general"],
          "type": "string",
          "description": "URL path to the logo image file"
        },
        "width": {
          "groups": ["general"],
          "type": "integer",
          "default": 100,
          "description": "Width of the logo in pixels"
        },
        "height": {
          "groups": ["general"],
          "type": "integer",
          "default": 100,
          "description": "Height of the logo in pixels"
        }
      }
    },
    "accessionPrefix": {
      "groups": ["general"],
      "group": "general",
      "type": "string",
      "default": "LOC_",
      "description": "Prefix used for accession numbers"
    },
    "environment": {
      "groups": ["general"],
      "type": "string",
      "enum": ["local", "server"],
      "default": "server",
      "description": "Deployment environment. local for development, server for production"
    },
    "host": {
      "groups": ["general"],
      "type": "string",
      "description": "Hostname where Loculus will be accessible"
    },
    "bannerMessage": {
      "groups": ["general"],
      "type": "string",
      "default": "This is a demonstration environment. It may contain non-accurate test data and should not be used for real-world applications. Data will be deleted regularly.",
      "description": "Banner message (as HTML) to display at the very top of the page"
    },
    "welcomeMessageHTML": {
      "groups": ["general"],
      "type": "string",
      "description": "A custom welcome message to be shown on the landing page"
    },
    "additionalHeadHTML": {
      "groups": ["general"],
      "type": "string",
      "description": "Additional HTML to inject into the <head> of pages"
    },
    "createTestAccounts": {
      "groups": ["general"],
      "type": "boolean",
      "description": "If true, creates the users testuser and superuser"
    },
    "robotsNoindexHeader": {
      "groups": ["general"],
      "type": "boolean",
      "description": "If true, adds a noindex header to prevent search engine indexing"
    },
    "seqSets": {
      "groups": ["general"],
      "type": "object",
      "properties": {
        "enabled": {
          "groups": ["general"],
          "type": "boolean",
          "description": "Enable/disable SeqSets. If false, `seqSets.crossRef` can be omitted."
        },
        "crossRef": {
          "groups": ["general"],
          "type": ["object"],
          "description": "Configuration for CrossRef integration. Set to `null` to disable CrossRef integration (you can still use SeqSets without CrossRef DOIs).",
          "properties": {
            "DOIPrefix": {
              "groups": ["general"],
              "type": "string",
              "description": "The DOI prefix for SeqSets"
            },
            "endpoint": {
              "groups": ["general"],
              "type": "string",
              "description": "The API endpoint for CrossRef"
            },
            "databaseName": {
              "groups": ["general"],
              "type": "string",
              "description": "The database name for CrossRef"
            },
            "email": {
              "groups": ["general"],
              "type": "string",
              "format": "email",
              "description": "The email address associated with the CrossRef account"
            },
            "organization": {
              "groups": ["general"],
              "type": "string",
              "description": "The organization name for CrossRef"
            },
            "hostUrl": {
              "groups": ["general"],
              "type": "string",
              "description": "The host URL for CrossRef callbacks"
            }
          }
        }
      }
    },
    "gitHubMainUrl": {
      "groups": ["general"],
      "type": "string",
      "default": "https://github.com/loculus-project/loculus",
      "description": "The link that the GitHub icon in the footer points to"
    },
    "website": {
      "websiteConfig": {
        "type": "object",
        "properties": {
          "enableLoginNavigationItem": {
            "type": "boolean",
            "default": true
          },
          "enableSubmissionNavigationItem": {
            "type": "boolean",
            "default": true
          },
          "enableSubmissionPages": {
            "type": "boolean",
            "default": true
          }
        }
      },
      "runtimeConfig": {
        "type": "object",
        "properties": {
          "public": {
            "type": "object",
            "properties": {
              "backendUrl": {
                "type": "string"
              },
              "keycloakUrl": {
                "type": "string"
              },
              "lapisUrlTemplate": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "auth": {
      "smtp": {
        "type": "object",
        "properties": {
          "host": { "type": "string" },
          "port": { "type": "integer" },
          "user": { "type": "string" },
          "replyTo": { "type": "string", "format": "email" },
          "from": { "type": "string", "format": "email" },
          "envelopeFrom": { "type": "string", "format": "email" }
        }
      },
      "verifyEmail": {
        "type": "boolean",
        "default": true
      },
      "resetPasswordAllowed": {
        "type": "boolean",
        "default": true
      },
      "registrationAllowed": {
        "type": "boolean",
        "default": true
      }
    },
    "organisms": {
      "type": "object",
      "patternProperties": {
        "^.*$": {
          "type": "object",
          "properties": {
            "schema": {
              "type": "object",
              "properties": {
                "organismName": {
                  "type": "string"
                },
                "image": {
                  "type": "string"
                },
                "loadSequencesAutomatically": {
                  "type": "boolean",
                  "default": true
                },
                "metadata": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "displayName": {
                        "type": "string"
                      },
                      "type": {
                        "type": "string"
                      },
                      "required": {
                        "type": "boolean"
                      },
                      "definition": {
                        "type": "string"
                      },
                      "guidance": {
                        "type": "string"
                      },
                      "generateIndex": {
                        "type": "boolean"
                      },
                      "autocomplete": {
                        "type": "boolean"
                      }
                    },
                    "required": ["name", "displayName", "type"]
                  }
                }
              },
              "required": ["organismName"]
            },
            "preprocessing": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "version": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "image": {
                    "type": "string"
                  },
                  "args": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "configFile": {
                    "type": "object"
                  }
                },
                "required": ["version", "image"]
              }
            },
            "referenceGenomes": {
              "type": "object",
              "properties": {
                "nucleotideSequences": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "sequence": {
                        "type": "string"
                      },
                      "insdcAccessionFull": {
                        "type": "string"
                      }
                    },
                    "required": ["name", "sequence"]
                  }
                },
                "genes": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "sequence": {
                        "type": "string"
                      }
                    },
                    "required": ["name", "sequence"]
                  }
                }
              }
            }
          },
          "required": ["schema"]
        }
      }
    },
    "lineageSystemDefinitions": {
      "type": "object",
      "patternProperties": {
        "^.*$": {
          "type": "object",
          "patternProperties": {
            "^[0-9]+$": {
              "type": "string",
              "format": "uri"
            }
          }
        }
      }
    }
  },
  "required": ["name"]
}