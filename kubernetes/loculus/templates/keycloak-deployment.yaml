---
{{- $dockerTag := include "loculus.dockerTag" .Values }}
apiVersion: apps/v1
kind: Deployment
metadata:
  name: loculus-keycloak
  annotations:
    argocd.argoproj.io/sync-options: Replace=true
    reloader.stakater.com/auto: "true"
spec:
  replicas: 1
  strategy:
    type: Recreate # So we don't get a rolling update
  selector:
    matchLabels:
      app: loculus
      component: keycloak
  template:
    metadata:
      labels:
        app: loculus
        component: keycloak
    spec:
      containers:
      - name: debug-echo
        image: ealen/echo-server:latest  # or hashicorp/http-echo
        ports:
          - containerPort: 8080
        env:
          - name: PORT
            value: "8080"