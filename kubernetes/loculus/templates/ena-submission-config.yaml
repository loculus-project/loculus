{{- $testconfig := .Values.testconfig | default false }}
{{- $backendHost := .Values.environment | eq "server" | ternary (printf "https://backend-%s" $.Values.host) "http://localhost:8079" }}
{{- $keycloakHost := .Values.environment | eq "server" | ternary (printf "https://authentication-%s" $.Values.host) "http://localhost:8083" }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: loculus-ena-submission-config
data:
  config.yaml: |
    backend_url: {{ $backendHost }}
    keycloak_token_url: {{ $keycloakHost -}}/realms/loculus/protocol/openid-connect/token
    {{- include "loculus.generateENASubmissionConfig" . | nindent 4 }}