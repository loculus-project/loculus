---
import { EnaDepositionPage } from '../../components/EnaDeposition/EnaDepositionPage';
import { getRuntimeConfig } from '../../config';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getAccessToken } from '../../utils/getAccessToken';

const accessToken = getAccessToken(Astro.locals.session);
const clientConfig = getRuntimeConfig().public;
const enaDepositionUrl = clientConfig.enaDepositionUrl;
---

<BaseLayout title='ENA Deposition Management'>
    <div class='max-w-7xl mx-auto px-4 py-6'>
        <h1 class='text-2xl font-bold text-gray-900 mb-6'>ENA Deposition Management</h1>
        {
            enaDepositionUrl === undefined ? (
                <div class='bg-gray-50 border border-gray-200 rounded-md p-4'>
                    <p class='text-gray-800'>ENA deposition is not configured for this instance.</p>
                </div>
            ) : accessToken === undefined ? (
                <div class='bg-yellow-50 border border-yellow-200 rounded-md p-4'>
                    <p class='text-yellow-800'>You must be logged in to manage ENA depositions.</p>
                </div>
            ) : (
                <EnaDepositionPage enaDepositionUrl={enaDepositionUrl} client:load />
            )
        }
    </div>
</BaseLayout>
