---
import { getConfiguredOrganisms } from '../config';
import BaseLayout from '../layouts/BaseLayout.astro';
import { routes } from '../routes';
const redirectTo = Astro.url.searchParams.get('redirectTo');

const purposes: { [key: string]: string } = {
    submit: 'for which you want to submit data',
    search: 'for which you want to browse data',
};

interface Routes {
    [key: string]: (organism: string) => string;
}

const myRoutes: Routes = {
    submit: routes.submitPage,
    search: routes.searchPage,
};

const purpose = purposes[redirectTo!];
---

<BaseLayout title='Home'>
    <div class='max-w-6xl mx-auto'>
        <p class='text-gray-700 my-4'>
            Please select an organism {purpose}.
        </p>

        <div class='flex flex-wrap'>
            {
                getConfiguredOrganisms().map(({ key, displayName, image, description }) => (
                    <a
                        href={myRoutes[redirectTo!](key)}
                        class='block rounded border border-gray-300 p-4 m-2 w-64 text-center hover:bg-gray-100'
                    >
                        {image !== undefined && <img src={image} class='h-32 mx-auto mb-4' alt={displayName} />}
                        <h3 class='font-semibold text-gray-700'>{displayName}</h3>
                        <p class='text-gray-700 text-sm'>{description}</p>
                    </a>
                ))
            }
        </div>
    </div>
</BaseLayout>
