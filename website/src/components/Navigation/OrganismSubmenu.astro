---
import { SubmenuLink } from './SubmenuLink.tsx';
import type { Organism } from '../../config';
import { extraSequenceRelatedTopNavigationItems } from '../../routes/extraTopNavigationItems';
import { getSequenceRelatedItems } from '../../routes/navigationItems';

interface Props {
    currentOrganism?: string;
    currentOrganismObject?: Organism;
    currentPath: string;
}

const { currentOrganism, currentOrganismObject, currentPath } = Astro.props;

// Get the navigation items for this organism
const sequenceRelatedItems = getSequenceRelatedItems(currentOrganism);
const extraItems = extraSequenceRelatedTopNavigationItems(currentOrganism);
---

{
    currentOrganism && (
        <nav class='bg-gray-50 border-gray-200 border-b-[1.5px]' aria-label='Organism navigation'>
            <div class='mx-4 px-4 py-3 flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4'>
                <div class='flex flex-col gap-1 text-sm font-medium text-gray-700 sm:flex-row sm:items-center sm:gap-3 sm:text-base'>
                    <span>{currentOrganismObject?.displayName || currentOrganism}</span>
                    <span class='hidden text-gray-300 sm:inline' aria-hidden='true'>
                        |
                    </span>
                </div>
                <div class='flex flex-wrap items-center gap-2 sm:flex-1'>
                    {sequenceRelatedItems.map(({ text, path, icon }) => {
                        const Icon = icon;
                        const isActive = currentPath.startsWith(path);
                        return (
                            <SubmenuLink href={path} isActive={isActive} className='flex-shrink-0'>
                                {Icon && <Icon className='w-4 h-4' aria-hidden='true' />}
                                <span>{text}</span>
                            </SubmenuLink>
                        );
                    })}
                    {extraItems.map(({ text, path }) => {
                        const isActive = currentPath.startsWith(path);
                        return (
                            <SubmenuLink href={path} isActive={isActive} className='flex-shrink-0'>
                                <span>{text}</span>
                            </SubmenuLink>
                        );
                    })}
                </div>
            </div>
        </nav>
    )
}
