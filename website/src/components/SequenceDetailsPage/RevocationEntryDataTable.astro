---
import DataTable from './DataTable.tsx';
import { getDataTableData } from './getDataTableData';
import { type TableDataEntry } from './types';
import {
    ACCESSION_VERSION_FIELD,
    SUBMITTED_AT_FIELD,
    RELEASED_AT_FIELD,
    IS_REVOCATION_FIELD,
    ACCESSION_FIELD,
    VERSION_COMMENT_FIELD,
    VERSION_STATUS_FIELD,
    SUBMITTER_FIELD,
    GROUP_NAME_FIELD,
    VERSION_FIELD,
    GROUP_ID_FIELD,
    DATA_USE_TERMS_FIELD,
} from '../../settings';
import { type DataUseTermsHistoryEntry } from '../../types/backend';
import type { ReferenceGenomes } from '../../types/referencesGenomes';
import type { SegmentReferenceSelections } from '../../utils/sequenceTypeHelpers';

interface Props {
    tableData: TableDataEntry[];
    dataUseTermsHistory: DataUseTermsHistoryEntry[];
    referenceGenomesMap: ReferenceGenomes;
    segmentReferences: SegmentReferenceSelections;
}

const { tableData, dataUseTermsHistory, referenceGenomesMap, segmentReferences } = Astro.props;

const relevantFieldsForRevocationVersions = [
    ACCESSION_VERSION_FIELD,
    ACCESSION_FIELD,
    IS_REVOCATION_FIELD,
    RELEASED_AT_FIELD,
    VERSION_COMMENT_FIELD,
    VERSION_STATUS_FIELD,
    SUBMITTED_AT_FIELD,
    SUBMITTER_FIELD,
    VERSION_FIELD,
    GROUP_NAME_FIELD,
    GROUP_ID_FIELD,
    DATA_USE_TERMS_FIELD,
];

const relevantData = tableData.filter((entry) => relevantFieldsForRevocationVersions.includes(entry.name));
const dataTableData = getDataTableData(relevantData);
---

<DataTable
    dataTableData={dataTableData}
    dataUseTermsHistory={dataUseTermsHistory}
    segmentReferences={segmentReferences}
    referenceGenomes={referenceGenomesMap}
/>
