name: Github Actions Usage Audit

on:
  workflow_dispatch:
  schedule:
    - cron: "0 3 * * *" # Runs at 03:00 AM (UTC) every day
  push:

jobs:
  gha-usage-minutes-report:
    runs-on: ubuntu-latest
    steps:
      - name: GitHub Actions Usage Audit
        uses: fergusmacd/github-action-usage@v0.9.2 # use a commit SHA
        # pass user input as arguments
        with:
          organisation: loculus-project
          gitHubAPIKey: ${{ secrets.ORG_READ }}
          loglevel: error # not required, change to debug if misbehaving
          raisealarmremainingminutes: 100 # not required, defaults to 100
          skipReposWithoutUsage: true
